<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type='text/css' href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css" />
    <link rel="icon" type="image/x-icon" href="/images/initials.png">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portfolio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #121212;
            color: #f4f4f4;
            margin: 0;
            padding: 0;
        }

        header {
            background: #1e1e1e;
            padding: 20px;
            text-align: center;
        }

        nav a {
            margin: 0 15px;
            color: #fff;
            text-decoration: none;
        }

        ul.no-bullets {
            list-style-type: none; /* Remove bullets */
            padding: 0; /* Remove padding */
            margin: 0; /* Remove margins */
            font-size: 60px
        }

        .section {
            padding: 40px 20px;
            max-width: 1100px;
            margin: auto;
        }

        label, select {
            font-size: 1rem;
        }

        #tagFilter {
            background: #1e1e1e;
            color: #f4f4f4;
            padding: 8px;
            margin: 20px 0;
            border: 1px solid #333;
            border-radius: 5px;
        }

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .card {
            background: #1e1e1e;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }

            /* Hover/inflate effect */
            .card:hover {
                transform: scale(1.05);
                box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            }

            .card img {
                width: 100%;
                height: 200px;
                object-fit: cover;
            }

        .card-body {
            padding: 15px;
            flex: 1;
        }

        .card h3 {
            margin-top: 0;
        }

        .card-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-start;
            padding: 0 15px 15px;
        }

            .card-buttons a {
                padding: 8px 16px;
                border-radius: 5px;
                text-decoration: none;
                font-weight: bold;
                color: #fff;
                transition: background 0.3s;
            }

                .card-buttons a:first-child {
                    background: #4caf50; /* Green for Play */
                }

                    .card-buttons a:first-child:hover {
                        background: #43a047;
                    }

                .card-buttons a:last-child {
                    background: #2196f3; /* Blue for Code */
                }

                    .card-buttons a:last-child:hover {
                        background: #1976d2;
                    }

        .carousel-container {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-bottom: 40px;
            width: 100%;
        }

        .carousel-track-wrapper {
            width: 960px; /* 3 cards visible (adjust as needed) */
            overflow: hidden;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease;
            will-change: transform;
        }

            .carousel-track .card {
                flex: 0 0 300px;
                margin: 0 10px;
                transition: transform 0.3s, opacity 0.3s;
                opacity: 0.6;
                transform: scale(0.9);
            }

                .carousel-track .card.active {
                    opacity: 1;
                    transform: scale(1.1);
                }

        #carousel-prev,
        #carousel-next {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            background: none;
            color: #fff;
            border: none;
            cursor: pointer;
            z-index: 10;
        }

        #carousel-prev {
            left: 0;
        }

        #carousel-next {
            right: 0;
        }

        footer {
            text-align: center;
            padding: 30px;
            background: #1e1e1e;
        }
    </style>
</head>
<body>

    <header>
        <h1>Thomas Bushnell</h1>
        <p>Game Programmer Portfolio</p>
        <nav>
            <a style="font-weight:900" href="#projects">Projects</a>
            <a style="font-weight:900" href="#skills">Skills</a>
            <a style="font-weight:900" href="#experience">Experience</a>
            <a style="font-weight:900" href="#about">About Me</a>
        </nav>
    </header>

    <section class="section" id="highlights">
        <h2>Highlights</h2>
        <div class="carousel-container">
            <button id="carousel-prev">&#10094;</button>
            <div class="carousel-track-wrapper">
                <div class="carousel-track" id="highlightCarouselTrack"></div>
            </div>
            <button id="carousel-next">&#10095;</button>
        </div>
    </section>

    <section class="section" id="projects">
        <h2>Projects</h2>

        <label for="tagFilter">Filter by tag:</label>
        <select id="tagFilter">
            <option value="all">All</option>
        </select>

        <div class="projects-grid" id="projectContainer"></div>
    </section>
    <section class="section" id="skills">
        <h2>Skills</h2>
        <ul class="no-bullets">
            <li class="list-inline-item">
                <i class="devicon-csharp-plain"></i>
            </li>
            <li class="list-inline-item">
                <i class="devicon-cplusplus-plain"></i>
            </li>
            <li class="list-inline-item">
                <i class="devicon-unity-plain"></i>
            </li>
            <li class="list-inline-item">
                <i class="devicon-visualstudio-plain"></i>
            </li>
            <li class="list-inline-item">
                <i class="devicon-github-plain"></i>
            </li>
        </ul>

    </section>

    <section class="section" id="experience">
        <h2>Experience</h2>
        <ul>
            <li>Micronav - Automated Testing</li>
        </ul>
    </section>

    <section class="section" id="about">
        <h2>About Me</h2>
        <p>Hi! I'm Tom, a First Year Games Technology student at the University of the West Of England </p>
    </section>

    <footer>
        <p>&copy; Thomas Bushnell</p>
    </footer>

    <script>
        // List your JSON files here
        const projectFiles = ['Pong.json', 'Platformer.json', 'Whack-a-Mole.json', 'Space-Invaders.json', 'Co-OpPuzzle.json', 'Interactive.json']; // Add your project JSON filenames here
        let allProjects = [];

        async function loadProjects() {
            const container = document.getElementById('projectContainer');
            const tagSelect = document.getElementById('tagFilter');
            const tags = new Set();

            for (const file of projectFiles) {
                const res = await fetch('projects/' + file);
                const proj = await res.json();
                allProjects.push(proj);
                (proj.tags || []).forEach(t => tags.add(t));
            }

            // build filter dropdown
            tags.forEach(t => {
                const o = document.createElement('option');
                o.value = t; o.textContent = t;
                tagSelect.appendChild(o);
            });
            tagSelect.addEventListener('change', () => display(tagSelect.value));
            display('all');

            const featuredProjects = allProjects.filter(p => p.featured);
            if (featuredProjects.length > 0) {
                displayCarousel(featuredProjects);
            }
        }
        function displayCarousel(projects) {
            const track = document.getElementById('highlightCarouselTrack');
            // Get the wrapper to determine its visible width
            const trackWrapper = document.querySelector('.carousel-track-wrapper'); // Added this line
            const visibleCards = 3;
            const cardWidth = 320; // 300px (card) + 20px (margin)

            let currentIndex = visibleCards; // Start from first real item
            let clonedProjects = [];


            function createCard(project, isClone = false) {
                const card = document.createElement('div');
                card.className = 'card';
                if (isClone) card.classList.add('clone');

                // Check for image and description before adding to card
                const imageUrl = project.image ? project.image : ''; // Fallback for missing image
                const description = project.description ? project.description : ''; // Fallback for missing description

                card.innerHTML = `
                        <img src="${imageUrl}" alt="${project.title}">
                        <div class="card-body">
                            <h3>${project.title}</h3>
                            <p>${description}</p>
                        </div>
                    `;

                // Add "Play" and "Code" buttons if links exist
                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'card-buttons';

                if (project.playLink) {
                    const playButton = document.createElement('a');
                    playButton.href = project.playLink;
                    playButton.target = "_blank";
                    playButton.textContent = "Play";
                    buttonsDiv.appendChild(playButton);
                }

                if (project.codeLink) {
                    const codeButton = document.createElement('a');
                    codeButton.href = project.codeLink;
                    codeButton.target = "_blank";
                    codeButton.textContent = "Code";
                    buttonsDiv.appendChild(codeButton);
                }

                // Append buttons only if there are any
                if (buttonsDiv.children.length > 0) {
                    card.appendChild(buttonsDiv);
                }

                card.addEventListener('click', () => {
                    if (project.detailLink) location.href = project.detailLink;
                });

                return card;
            }

            function setupCarousel() {
                track.innerHTML = '';
                clonedProjects = [];
                const total = projects.length;

                for (let i = total - visibleCards; i < total; i++) {
                    const clone = createCard(projects[i], true);
                    track.appendChild(clone);
                }

                projects.forEach(p => {
                    const card = createCard(p);
                    track.appendChild(card);
                });

                for (let i = 0; i < visibleCards; i++) {
                    const clone = createCard(projects[i], true);
                    track.appendChild(clone);
                }

                updateCarouselPosition(false);
            }

            function updateCarouselPosition(animate = true) {
                // Calculate the offset to center the current card
                const wrapperWidth = trackWrapper.offsetWidth; // Get the actual width of the wrapper
                const targetCardLeft = currentIndex * cardWidth; // Left edge of the target card relative to the start of the track
                const centerOffset = (wrapperWidth / 2) - (cardWidth / 2); // How much to shift to center one card
                const finalOffset = -targetCardLeft + centerOffset; // Combined offset

                if (!animate) {
                    track.style.transition = 'none';
                } else {
                    track.style.transition = 'transform 0.5s ease';
                }

                track.style.transform = `translateX(${finalOffset}px)`;

                // Highlight the center card
                const cards = track.querySelectorAll('.card');
                cards.forEach(card => card.classList.remove('active'));
                const centerCard = cards[currentIndex];
                if (centerCard) centerCard.classList.add('active');
            }

            function shiftCarousel(direction) {
                const total = projects.length;

                currentIndex += direction;
                updateCarouselPosition(true);

                track.addEventListener('transitionend', handleLoop, { once: true });

                function handleLoop() {
                    if (currentIndex >= total + visibleCards) {
                        currentIndex = visibleCards;
                        updateCarouselPosition(false);
                    } else if (currentIndex < visibleCards) {
                        currentIndex = total + visibleCards - 1;
                        updateCarouselPosition(false);
                    }
                }
            }

            document.getElementById('carousel-prev').onclick = () => shiftCarousel(-1);
            document.getElementById('carousel-next').onclick = () => shiftCarousel(1);

            setupCarousel();
        }

        function display(filterTag) {
            const container = document.getElementById('projectContainer');
            container.innerHTML = '';
            const list = filterTag === 'all'
                ? allProjects
                : allProjects.filter(p => p.tags && p.tags.includes(filterTag));

            list.forEach(p => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                        <img src="${p.image}" alt="${p.title}">
                        <div class="card-body">
                            <h3>${p.title}</h3>
                            <p>${p.description}</p>
                        </div>`;

                // Add "Play" and "Code" buttons if links exist, similar to the carousel
                const buttonsDiv = document.createElement('div');
                buttonsDiv.className = 'card-buttons';

                if (p.playLink) {
                    const playButton = document.createElement('a');
                    playButton.href = p.playLink;
                    playButton.target = "_blank";
                    playButton.textContent = "Play";
                    buttonsDiv.appendChild(playButton);
                }

                if (p.codeLink) {
                    const codeButton = document.createElement('a');
                    codeButton.href = p.codeLink;
                    codeButton.target = "_blank";
                    codeButton.textContent = "Code";
                    buttonsDiv.appendChild(codeButton);
                }

                if (buttonsDiv.children.length > 0) {
                    card.appendChild(buttonsDiv);
                }

                // click to go to detail page
                card.addEventListener('click', () => {
                    // Only navigate if a detailLink exists AND the click wasn't on a button
                    // This ensures buttons within the card can be clicked without triggering navigation
                    if (p.detailLink && !event.target.closest('.card-buttons a')) {
                        location.href = p.detailLink;
                    }
                });

                container.appendChild(card);
            });
        }

        loadProjects();
    </script>

</body>
</html>